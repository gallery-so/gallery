import unescapeFn from 'lodash.unescape';

/** Fixes bug where lodash.unescape does not unescape double quotes in our code base */
export default function unescape(string_: string | undefined) {
  // Check to see if string includes the double quote character; if string does not have it, this is slightly faster
  // https://perf.link/#eyJpZCI6ImdubDgwbmp6cWduIiwidGl0bGUiOiJGaW5kaW5nIG51bWJlcnMgaW4gYW4gYXJyYXkgb2YgMTAwMCIsImJlZm9yZSI6ImNvbnN0IHN0ciA9IFwiVGhpcyAgaXMgYSBzdHJpbmdcIiIsInRlc3RzIjpbeyJuYW1lIjoiVGVzdCBDYXNlIiwiY29kZSI6InN0ci5yZXBsYWNlQWxsKFwiJiMzOTtcIiwgJ1wiJykiLCJydW5zIjpbOTgwMDAsMTEwMDAsMTQxNTAwMCw5MzMwMDAsMjY5NDAwMCw3NzQ1MDAwLDkwMDAsNTMwMDAwLDcxMzcwMDAsMTQ5OTAwMCwxNTE0MDAwLDUyMzAwMCwxNjMzMDAwLDExMzkwMDAsMTM1MzAwMCwxNzAxMDAwLDMxMzQwMDAsNTI3MDAwLDEwMDAwMCwyMTgzMDAwLDkwMDAsMTY0NjAwMCwxMDAwLDI5OTMwMDAsMzU0MDAwLDM1NzQwMDAsMTQ3MTAwMCwxMTAwMCwxNTMwMDAwLDM4OTQwMDAsNTMzMDAwLDE0OTkwMDAsNzEzMDAwMCwyMzk2MDAwLDI0NDAwMCw4NDUwMDAsMTY1MjAwMCwzMDAwMCwxMDAwMDAsMjU5MTAwMCw5MDAwLDU3MzAwMCw4OTYwMDAsMjU4NzAwMCwzNTE2MDAwLDE0ODUwMDAsMzU3ODAwMCwyMzY4MDAwLDE0OTkwMDAsMjA3NzAwMCw4NTUwMDAsNDQxNTAwMCw0NjE0MDAwLDExNjMwMDAsMTI2NzAwMCwxNzMyMDAwLDExMDAwLDE2NDYwMDAsMTEwMDAsNDYxMTAwMCwxNjE2MDAwLDkwMDAsMzEwNTAwMCw0MjUwMDAwLDEwMDAwLDE2NzQwMDAsMzk2MDAwLDYxNzUwMDAsNjQ0MDAwLDE0OTkwMDAsMTAwMDAsMTczMzAwMCwyMzA5MDAwLDUyMjkwMDAsNDA2MzAwMCw0NTY1MDAwLDc4OTAwMCwyODgyMDAwLDkwMDAsOTAwMCwyMjQxMDAwLDYyNTcwMDAsMTU0NzAwMCwyNjA3MDAwLDEwMDAwMCwzMzc4MDAwLDU0MDAwMCw5ODAwMCwxODEyMDAwLDE1MzkwMDAsMzYzOTAwMCwxMzgxMDAwLDE0OTkwMDAsOTAwMCwxMDAwMCwxMDgwMDAsMTAwMDAsNDYwOTAwMCw1NjUwMDAsMTY4NTAwMF0sIm9wcyI6MTgxOTA0MH0seyJuYW1lIjoiVGVzdCBDYXNlIiwiY29kZSI6InN0ci5pbmNsdWRlcyhcIiYjMzk7XCIpID8gc3RyLnJlcGxhY2VBbGwoXCImIzM5O1wiLCAnXCInKSA6IHN0ciIsInJ1bnMiOlsxMDAwMCw5MzAwMCwxNDkyMDAwLDIzMzQwMDAsNTcyODAwMCwxMDc5MTAwMCw5MDAwLDE5NDMwMDAsMTE2MzYwMDAsNDI3MjAwMCwzNzM3MDAwLDI4MDEwMDAsMzczNTAwMCw0MTY1MDAwLDE5OTAwMCwzMjIxMDAwLDQ4MTYwMDAsMTkyNTAwMCwxMTAxMDAwLDQwOTgwMDAsNzEwNjAwMCw0NDcxMDAwLDU3MzYwMDAsNjM1MjAwMCwxMjU4MDAwLDYyMjcwMDAsMzUxMzAwMCwzNjAwMDAsNDg2MjAwMCw1NjE3MDAwLDE2NTcwMDAsMzQ3NTAwMCwxMDQ2MDAwMCw0NjQwMDAwLDE0MDgwMDAsMTY0NjAwMCwzNzMwMDAwLDI3OTkwMDAsMzY0MDAwLDU5NzkwMDAsOTAwMCwxNjQ2MDAwLDM3NTUwMDAsNTAyMTAwMCw1NzYyMDAwLDM2NzQwMDAsNTg5ODAwMCw1NTgwMDAwLDI3MTgwMDAsMzk2NjAwMCwzNDEyMDAwLDU4NjAwMDAsNjcxODAwMCwzMzQ3MDAwLDE3NzIwMDAsNTMyOTAwMCw2NjE0MDAwLDM4MDkwMDAsOTgwMDAsNjY0MzAwMCw0MDA2MDAwLDY3MDcwMDAsNTQ0OTAwMCw2MzMyMDAwLDMyNDAwMCw0NDUyMDAwLDI1NjUwMDAsODQ0MjAwMCwxNjQ2MDAwLDMwNjAwMDAsMTAwMDAsMzg2MzAwMCw1NTM3MDAwLDcxODAwMDAsNzQyMDAwMCw3MTYwMDAwLDE2NDYwMDAsMTQ3NTAwMCwxMDAwMCw5MDAwLDUwOTMwMDAsOTM0NjAwMCwzNzM1MDAwLDQ0NDcwMDAsMTI3ODAwMCw2MDI5MDAwLDE4MjgwMDAsMjI3MDAwMCw0MDI5MDAwLDM5ODcwMDAsNjEwMTAwMCwzMjU5MDAwLDU3NzYwMDAsOTAwMCwxMDkwMDAsMTAzNzAwMCw5MDAwLDU2NzcwMDAsMjA0NzAwMCw0MTIwMDAwXSwib3BzIjozNzg4NzYwfV0sInVwZGF0ZWQiOiIyMDIyLTAzLTIyVDAwOjMzOjQ0Ljk1N1oifQ%3D%3D
  return string_?.includes('&#34;')
    ? unescapeFn(string_).replaceAll('&#34;', '"')
    : unescapeFn(string_); // If string is undefined (e.g. empty) this will just return ""
}
